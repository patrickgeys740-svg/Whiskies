<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Scanner</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="input-container">
        <h1>Barcode Scanner</h1>
        <form method="post">
            <label for="barcode">Barcode:</label>
            <input type="text" id="barcode" name="barcode" autocomplete="off" required>

            <label for="aantal">Aantal:</label>
            <input type="number" id="aantal" name="aantal" autocomplete="off" required>

            <button type="submit">Verwerken</button>
        </form>

        <!-- Willekeurige kaart bij scan -->
        <div id="drawn-card" class="drawn-card"></div>
    </div>

    <div class="scanned-container">
        <h2>Scanned Data</h2>
        <table>
            <thead>
                <tr>
                    <th>Barcode</th>
                    <th>Volledige Naam</th>
                    <th>Aantal</th>
                    <th>Actie</th>
                </tr>
            </thead>
            <tbody>
                {% for item in scanned_data %}
                    <tr>
                        <td>{{ item.barcode }}</td>
                        <td>{{ item.naam }}</td>
                        <td>{{ item.aantal }}</td>
                        <td>
                            <form method="post" action="{{ url_for('remove_entry') }}">
                                <input type="hidden" name="barcode" value="{{ item.barcode }}">
                                <input type="hidden" name="aantal" value="{{ item.aantal }}">
                                <button type="submit">Verwijderen</button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="total-container">
        <h2>Totaal aantal scans: {{ total_scans }}</h2>

        <!-- Animatie van 4 kaarten -->
        <div class="card-animation">
            <div class="card black card1">♠</div>
            <div class="card red card2">♥</div>
            <div class="card black card3">♣</div>
            <div class="card red card4">♦</div>
        </div>
    </div>

    <script>
        window.onload = function () {
            const barcodeInput = document.getElementById("barcode");
            const aantalInput = document.getElementById("aantal");
            const form = document.querySelector("form");
            const drawnCardDiv = document.getElementById("drawn-card");

            barcodeInput.focus();

            barcodeInput.addEventListener("keypress", function (e) {
                if (e.key === "Enter") {
                    e.preventDefault();
                    aantalInput.focus();
                    aantalInput.select();
                }
            });

            aantalInput.addEventListener("keypress", function (e) {
                if (e.key === "Enter") {
                    e.preventDefault();
                    drawCard();
                    setTimeout(() => {
                        form.submit();
                    }, 400);
                }
            });

            function drawCard() {
                const suits = ['♠', '♥', '♣', '♦'];
                const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
                const suit = suits[Math.floor(Math.random() * suits.length)];
                const value = values[Math.floor(Math.random() * values.length)];

                drawnCardDiv.textContent = `${suit} ${value}`;
                drawnCardDiv.className = 'drawn-card show';

                if (suit === '♥' || suit === '♦') {
                    drawnCardDiv.classList.add('red-suit');
                } else {
                    drawnCardDiv.classList.add('black-suit');
                }

                setTimeout(() => {
                    drawnCardDiv.classList.remove('show');
                }, 1500);
            }
        };
    </script>
</body>
</html>
